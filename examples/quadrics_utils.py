def Q(a,b,c,d,e,f,g,x,y,z): return a*x**2 + b*y**2 + c*z**2 + d + 2*e*x + 2*f*y + 2*g*z
def y_as_x(a,b,c,d,e,f,g,x): return f*x/(e - x*(-a + b))
def z_as_x(a,b,c,d,e,f,g,x): return g*x/(e - x*(-a + c))
def Q_as_x(a,b,c,d,e,f,g,x): return a*x**2 + b*f**2*x**2/(e - x*(-a + b))**2 + c*g**2*x**2/(e - x*(-a + c))**2 + d + 2*e*x + 2*f**2*x/(e - x*(-a + b)) + 2*g**2*x/(e - x*(-a + c))
def k_mat(a,b,c,d,e,f,g): return [a*(a - b)**2*(a - c)**2, 2*e*(a - b)*(a - c)*(3*a**2 - 2*a*b + c*(-2*a + b)), d*(a**4 - 2*a**3*b + a**2*b**2 + c**2*(a**2 - 2*a*b + b**2) + c*(-2*a**3 + 4*a**2*b - 2*a*b**2)) + e**2*(14*a**3 - 18*a**2*b + 5*a*b**2 + c**2*(5*a - 4*b) + c*(-18*a**2 + 20*a*b - 4*b**2)) + f**2*(2*a**3 - a**2*b + c**2*(2*a - b) + c*(-4*a**2 + 2*a*b)) + g**2*(2*a**3 - a**2*c + b**2*(2*a - c) + b*(-4*a**2 + 2*a*c)), 2*e*(d*(2*a**3 - 3*a**2*b + a*b**2 + c**2*(a - b) + c*(-3*a**2 + 4*a*b - b**2)) + e**2*(8*a**2 - 7*a*b + b**2 + c**2 + c*(-7*a + 4*b)) + f**2*(3*a**2 - a*b + c**2 + c*(-4*a + b)) + g**2*(3*a**2 - 4*a*b + b**2 + c*(-a + b))), e**2*(d*(6*a**2 - 6*a*b + b**2 + c**2 + c*(-6*a + 4*b)) + e**2*(9*a - 4*b - 4*c) + f**2*(6*a - b - 4*c) + g**2*(6*a - 4*b - c)), 2*e**3*(d*(2*a - b - c) + e**2 + f**2 + g**2), d*e**4]
def k_jac(a,b,c,d,e,f,g): return [[a*(a - b)**2*(2*a - 2*c) + a*(a - c)**2*(2*a - 2*b) + (a - b)**2*(a - c)**2, a*(-2*a + 2*b)*(a - c)**2, a*(-2*a + 2*c)*(a - b)**2, 0, 0, 0, 0], [2*e*(a - b)*(a - c)*(6*a - 2*b - 2*c) + 2*e*(a - b)*(3*a**2 - 2*a*b + c*(-2*a + b)) + 2*e*(a - c)*(3*a**2 - 2*a*b + c*(-2*a + b)), 2*e*(-2*a + c)*(a - b)*(a - c) - 2*e*(a - c)*(3*a**2 - 2*a*b + c*(-2*a + b)), 2*e*(-2*a + b)*(a - b)*(a - c) - 2*e*(a - b)*(3*a**2 - 2*a*b + c*(-2*a + b)), 0, (a - c)*(2*a - 2*b)*(3*a**2 - 2*a*b + c*(-2*a + b)), 0, 0], [d*(4*a**3 - 6*a**2*b + 2*a*b**2 + c**2*(2*a - 2*b) + c*(-6*a**2 + 8*a*b - 2*b**2)) + e**2*(42*a**2 - 36*a*b + 5*b**2 + 5*c**2 + c*(-36*a + 20*b)) + f**2*(6*a**2 - 2*a*b + 2*c**2 + c*(-8*a + 2*b)) + g**2*(6*a**2 - 2*a*c + 2*b**2 + b*(-8*a + 2*c)), d*(-2*a**3 + 2*a**2*b + c**2*(-2*a + 2*b) + c*(4*a**2 - 4*a*b)) + e**2*(-18*a**2 + 10*a*b - 4*c**2 + c*(20*a - 8*b)) + f**2*(-a**2 + 2*a*c - c**2) + g**2*(-4*a**2 + 2*a*c + 2*b*(2*a - c)), d*(-2*a**3 + 4*a**2*b - 2*a*b**2 + 2*c*(a**2 - 2*a*b + b**2)) + e**2*(-18*a**2 + 20*a*b - 4*b**2 + 2*c*(5*a - 4*b)) + f**2*(-4*a**2 + 2*a*b + 2*c*(2*a - b)) + g**2*(-a**2 + 2*a*b - b**2), a**4 - 2*a**3*b + a**2*b**2 + c**2*(a**2 - 2*a*b + b**2) + c*(-2*a**3 + 4*a**2*b - 2*a*b**2), 2*e*(14*a**3 - 18*a**2*b + 5*a*b**2 + c**2*(5*a - 4*b) + c*(-18*a**2 + 20*a*b - 4*b**2)), 2*f*(2*a**3 - a**2*b + c**2*(2*a - b) + c*(-4*a**2 + 2*a*b)), 2*g*(2*a**3 - a**2*c + b**2*(2*a - c) + b*(-4*a**2 + 2*a*c))], [2*e*(d*(6*a**2 - 6*a*b + b**2 + c**2 + c*(-6*a + 4*b)) + e**2*(16*a - 7*b - 7*c) + f**2*(6*a - b - 4*c) + g**2*(6*a - 4*b - c)), 2*e*(d*(-3*a**2 + 2*a*b - c**2 + c*(4*a - 2*b)) + e**2*(-7*a + 2*b + 4*c) + f**2*(-a + c) + g**2*(-4*a + 2*b + c)), 2*e*(d*(-3*a**2 + 4*a*b - b**2 + 2*c*(a - b)) + e**2*(-7*a + 4*b + 2*c) + f**2*(-4*a + b + 2*c) + g**2*(-a + b)), 2*e*(2*a**3 - 3*a**2*b + a*b**2 + c**2*(a - b) + c*(-3*a**2 + 4*a*b - b**2)), 2*d*(2*a**3 - 3*a**2*b + a*b**2 + c**2*(a - b) + c*(-3*a**2 + 4*a*b - b**2)) + 6*e**2*(8*a**2 - 7*a*b + b**2 + c**2 + c*(-7*a + 4*b)) + 2*f**2*(3*a**2 - a*b + c**2 + c*(-4*a + b)) + 2*g**2*(3*a**2 - 4*a*b + b**2 + c*(-a + b)), 4*e*f*(3*a**2 - a*b + c**2 + c*(-4*a + b)), 4*e*g*(3*a**2 - 4*a*b + b**2 + c*(-a + b))], [e**2*(d*(12*a - 6*b - 6*c) + 9*e**2 + 6*f**2 + 6*g**2), e**2*(d*(-6*a + 2*b + 4*c) - 4*e**2 - f**2 - 4*g**2), e**2*(d*(-6*a + 4*b + 2*c) - 4*e**2 - 4*f**2 - g**2), e**2*(6*a**2 - 6*a*b + b**2 + c**2 + c*(-6*a + 4*b)), 2*e**3*(9*a - 4*b - 4*c) + 2*e*(d*(6*a**2 - 6*a*b + b**2 + c**2 + c*(-6*a + 4*b)) + e**2*(9*a - 4*b - 4*c) + f**2*(6*a - b - 4*c) + g**2*(6*a - 4*b - c)), 2*e**2*f*(6*a - b - 4*c), 2*e**2*g*(6*a - 4*b - c)], [4*d*e**3, -2*d*e**3, -2*d*e**3, 2*e**3*(2*a - b - c), 4*e**4 + 6*e**2*(d*(2*a - b - c) + e**2 + f**2 + g**2), 4*e**3*f, 4*e**3*g], [0, 0, 0, e**4, 4*d*e**3, 0, 0]]
def k0(a,b,c,d,e,f,g): return d*e**4
def k1(a,b,c,d,e,f,g): return 2*e**3*(d*(2*a - b - c) + e**2 + f**2 + g**2)
def k2(a,b,c,d,e,f,g): return e**2*(d*(6*a**2 - 6*a*b + b**2 + c**2 + c*(-6*a + 4*b)) + e**2*(9*a - 4*b - 4*c) + f**2*(6*a - b - 4*c) + g**2*(6*a - 4*b - c))
def k3(a,b,c,d,e,f,g): return 2*e*(d*(2*a**3 - 3*a**2*b + a*b**2 + c**2*(a - b) + c*(-3*a**2 + 4*a*b - b**2)) + e**2*(8*a**2 - 7*a*b + b**2 + c**2 + c*(-7*a + 4*b)) + f**2*(3*a**2 - a*b + c**2 + c*(-4*a + b)) + g**2*(3*a**2 - 4*a*b + b**2 + c*(-a + b)))
def k4(a,b,c,d,e,f,g): return d*(a**4 - 2*a**3*b + a**2*b**2 + c**2*(a**2 - 2*a*b + b**2) + c*(-2*a**3 + 4*a**2*b - 2*a*b**2)) + e**2*(14*a**3 - 18*a**2*b + 5*a*b**2 + c**2*(5*a - 4*b) + c*(-18*a**2 + 20*a*b - 4*b**2)) + f**2*(2*a**3 - a**2*b + c**2*(2*a - b) + c*(-4*a**2 + 2*a*b)) + g**2*(2*a**3 - a**2*c + b**2*(2*a - c) + b*(-4*a**2 + 2*a*c))
def k5(a,b,c,d,e,f,g): return 2*e*(a - b)*(a - c)*(3*a**2 - 2*a*b + c*(-2*a + b))
def k6(a,b,c,d,e,f,g): return a*(a - b)**2*(a - c)**2
